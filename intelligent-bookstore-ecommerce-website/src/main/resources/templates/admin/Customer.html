<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Khách Hàng</title>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" th:href="@{/admin/css/style.css}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="text/javascript" src="/admin/Customer/js/main.js"></script>
</head>
<body>
<div class="row">
    <div class="col-2">
        <div style="margin-left: 20px !important;">
            <div th:replace="~{admin/Navbar :: navbar}"></div>
        </div>
    </div>
    <div class="col-9">
        <main>
            <h1>Khách Hàng</h1>
            <form th:action="@{/admin/customer}" method="get" class="mb-3">
                <div class="input-group" style="width: 75vw;">
                    <input type="text"
                           name="keyword"
                           id="searchInput"
                           class="form-control"
                           placeholder="Nhập tên khách hàng"
                           th:value="${keyword}"
                           style="margin-right:10px;">
                    <button type="submit" class="btn btn-primary" style="margin-right:10px;">Tìm kiếm</button>
<!--                    <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addModal">-->
<!--                        Thêm-->
<!--                    </button>-->
                </div>
            </form>

            <div class="table-responsive">
                <table class="table">
                    <thead>
                    <tr>
                        <th>STT</th>
                        <th>Username</th>
                        <th>Tên Khách Hàng</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Giới Tính</th>
                        <th>Ngày Sinh</th>
                        <th>Địa Chỉ</th>
                        <th>Trạng Thái</th>
                        <th>Thao Tác</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="customer, iterStat : ${customers}">
                        <td th:text="${iterStat.count}"></td>
                        <td th:text="${customer.userId}"></td>
                        <td th:text="${customer.fullName}"></td>
                        <td th:text="${customer.email}"></td>
                        <td th:text="${customer.phone}"></td>
                        <td th:text="${customer.gender ? 'Nữ' : 'Nam'}"></td>
                        <td th:text="${#temporals.format(customer.birthday, 'dd/MM/yyyy')}"></td>
                        <td th:text="${customer.address}"></td>
                        <td th:text="${customer.isActive ? 'Kích hoạt' : 'Vô hiệu'}"></td>
                        <td>
<!--                            <button class="btn btn-warning btn-sm"-->
<!--                                    th:onclick="'editCustomer(' + ${customer.userId} + ')'">Sửa-->
<!--                            </button>-->
<!--                            <button class="btn btn-danger btn-sm"-->
<!--                                    th:onclick="'deleteCustomer(' + ${customer.userId} + ')'">Xóa-->
<!--                            </button>-->

<!--                            <button class="btn btn-warning btn-sm"-->
<!--                                    th:attr="onclick='editCustomer(' + ${customer.userId} + ')'" >Sửa-->
<!--                            </button>-->
<!--                            <button class="btn btn-danger btn-sm"-->
<!--                                    th:attr="onclick='deleteCustomer(' + ${customer.userId} + ')'" >Xóa-->
<!--                            </button>-->

                            <button class="btn btn-warning btn-sm"
                                    th:attr="onclick='editCustomer(' + '\'' + ${customer.userId} + '\'' + ')'" >Sửa
                            </button>
                            <button class="btn btn-danger btn-sm"
                                    th:attr="onclick='deleteCustomer(' + '\'' + ${customer.userId} + '\'' + ')'" >Xóa
                            </button>


                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="d-flex justify-content-between align-items-center mt-4">
                <div class="text-muted">
                    Hiển thị
                    <span th:text="${customers.numberOfElements}">0</span>
                    trong tổng số
                    <span th:text="${customers.totalElements}">0</span>
                    khách hàng
                </div>

                <nav th:if="${customers.totalPages > 1}">
                    <ul class="pagination mb-0">
                        <!-- First Page -->
                        <li class="page-item" th:classappend="${customers.first ? 'disabled' : ''}">
                            <a class="page-link" th:href="@{/admin/customer(page=0, size=${customers.size}, keyword=${param.keyword})}"
                               aria-label="First">
                                <span aria-hidden="true">&laquo;&laquo;</span>
                            </a>
                        </li>

                        <!-- Previous Page -->
                        <li class="page-item" th:classappend="${customers.first ? 'disabled' : ''}">
                            <a class="page-link"
                               th:href="@{/admin/customer(page=${customers.number - 1}, size=${customers.size}, keyword=${param.keyword})}"
                               aria-label="Previous">
                                <span aria-hidden="true">&laquo;</span>
                            </a>
                        </li>

                        <!-- Page Numbers -->
                        <li class="page-item"
                            th:each="pageNumber : ${#numbers.sequence(0, customers.totalPages - 1)}"
                            th:classappend="${pageNumber == customers.number ? 'active' : ''}"
                            th:if="${pageNumber >= customers.number - 2 and pageNumber <= customers.number + 2}">
                            <a class="page-link"
                               th:href="@{/admin/customer(page=${pageNumber}, size=${customers.size}, keyword=${param.keyword})}"
                               th:text="${pageNumber + 1}">1</a>
                        </li>

                        <li class="page-item" th:classappend="${customers.last ? 'disabled' : ''}">
                            <a class="page-link"
                               th:href="@{/admin/customer(page=${customers.number + 1}, size=${customers.size}, keyword=${param.keyword})}"
                               aria-label="Next">
                                <span aria-hidden="true">&raquo;</span>
                            </a>
                        </li>

                        <li class="page-item" th:classappend="${customers.last ? 'disabled' : ''}">
                            <a class="page-link"
                               th:href="@{/admin/customer(page=${customers.totalPages - 1}, size=${customers.size}, keyword=${param.keyword})}"
                               aria-label="Last">
                                <span aria-hidden="true">&raquo;&raquo;</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </main>
    </div>
</div>

<!-- Modal Thêm Khách Hàng -->
<!--<div class="modal fade" id="addModal" tabindex="-1">-->
<!--    <div class="modal-dialog">-->
<!--        <div class="modal-content">-->
<!--            <div class="modal-header">-->
<!--                <h5 class="modal-title">Thêm Khách Hàng Mới</h5>-->
<!--                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>-->
<!--            </div>-->
<!--            <div class="modal-body">-->
<!--                <form th:action="@{/admin/customer/add}" method="post">-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Username</label>-->
<!--                        <input type="text" class="form-control" name="userId" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Email</label>-->
<!--                        <input type="email" class="form-control" name="email" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Phone</label>-->
<!--                        <input type="text" class="form-control" name="phone" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Tên Khách Hàng</label>-->
<!--                        <input type="text" class="form-control" name="fullName" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Giới Tính</label>-->
<!--                        <select class="form-control" name="gender">-->
<!--                            <option value="false">Nữ</option>-->
<!--                            <option value="true">Nam</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Ngày Sinh</label>-->
<!--                        <input type="date" class="form-control" name="birthday" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Mật Khẩu</label>-->
<!--                        <input type="password" class="form-control" name="pwd" required>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Địa Chỉ</label>-->
<!--                        <textarea class="form-control" name="address" required></textarea>-->
<!--                    </div>-->
<!--                    <div class="mb-3">-->
<!--                        <label class="form-label">Trạng Thái</label>-->
<!--                        <select class="form-control" name="isActive" required>-->
<!--                            <option value="false">Vô hiệu</option>-->
<!--                            <option value="true">Kích hoạt</option>-->
<!--                        </select>-->
<!--                    </div>-->
<!--                    <button type="submit" class="btn btn-primary">Thêm mới</button>-->
<!--                </form>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!-- Modal Sửa Khách Hàng -->
<div class="modal fade" id="editModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Sửa Thông Tin Khách Hàng</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form th:action="@{/admin/customer/edit}" method="post">
                    <input type="hidden" id="editCustomerId" name="customerId">
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" id="editEmail" name="email" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Phone</label>
                        <input type="text" class="form-control" id="editPhone" name="phone" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Tên Khách Hàng</label>
                        <input type="text" class="form-control" id="editFullName" name="fullName" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Giới Tính</label>
                        <select class="form-control" id="editGender" name="gender">
                            <option value="false">Nữ</option>
                            <option value="true">Nam</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ngày Sinh</label>
                        <input type="date" class="form-control" id="editBirthday" name="birthday" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Địa Chỉ</label>
                        <textarea class="form-control" id="editAddress" name="address" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Trạng Thái</label>
                        <select class="form-control" id="editIsActive" name="isActive">
                            <option value="false">Vô hiệu</option>
                            <option value="true">Kích hoạt</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Cập nhật</button>
                </form>
            </div>
        </div>
    </div>
</div>
</body>

<div th:if="${param.success}" class="alert alert-success alert-dismissible fade show" role="alert" id="successAlert"
     style="position: fixed; top: 20px; right: 20px; z-index: 1050; min-width: 300px;">
    <span th:if="${param.success[0] == 'add'}">Thêm khách hàng thành công!</span>
    <span th:if="${param.success[0] == 'edit'}">Cập nhật khách hàng thành công!</span>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>

<div th:if="${param.error}" class="alert alert-danger alert-dismissible fade show" role="alert" id="errorAlert"
     style="position: fixed; top: 20px; right: 20px; z-index: 1050; min-width: 300px;">
    <span th:if="${param.error[0] == 'add'}">Thêm khách hàng thất bại!</span>
    <span th:if="${param.error[0] == 'edit'}">Cập nhật khách hàng thất bại!</span>
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
</html>